<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="./js/axios.min.js"></script>
    <script src="./js/index.js"></script>
    <link rel="stylesheet" href="./css/reset.css" />
    <link rel="stylesheet" href="./css/public.css" />
    <link rel="stylesheet" href="./css/login.css" />
    <link
      rel="stylesheet"
      href="http://at.alicdn.com/t/font_2983992_vg38s8bm6l9.css"
    />
  </head>
  <body>
    <div id="login">
      <div class="public-nav">
        <div class="nav-content">
          <div class="nav-left">
            <a href="javascript:void(0)"
              ><i class="iconfont icon-favorfill"></i>收藏花礼网(hua.com)</a
            >
            <a href="javascript:void(0)" class="nav-dropdown"
              ><i class="iconfont icon-weixin"></i>关注微信
              <b class="weixin"
                ><img src="./images/regin/wxguanjia.png" alt="" />
                <h4>扫码关注</h4>
                <h5>回复"礼物"更多惊喜！</h5></b
              ></a
            >
            <a href="javascript:void(0)" class="nav-dropdown"
              ><i class="iconfont icon-shouji1"></i>花礼网App<b
                ><img src="./images/regin/app.png" alt="" />
                <h4>新人专享100元APP礼包</h4></b
              ></a
            >
          </div>
          <div class="nav-right">
            <a href="./login.html" class="loginName">你好，请登录</a>
            <a href="./regin.html" class="quitName">注册</a>
            <a href="javascript:void(0)"><span>订单查询</span></a>
            <a href="javascript:void(0)"><span>我的花礼</span></a>
            <a href="javascript:void(0)"><span>客户服务</span></a>
            <a href="cart.html" class="nav-dropdown"
              ><span
                ><i class="iconfont icon-gouwugouwuchedinggou"></i>购物车<b
                  class="cart"
                  ><h4>您的购物车中没有商品，先去选购吧！</h4></b
                ></span
              ></a
            >
            <a href="javascript:void(0)"
              ><span>鲜花礼品网：中国领先的鲜花网品牌</span></a
            >
          </div>
        </div>
      </div>
      <!-- 头部****** -->
      <div class="public-header">
        <div class="header-content">
          <a href="./index.html">
            <img src="./images/regin/big-logo.png" alt=""
          /></a>
          <div class="search">
            <input type="text" placeholder="商品关键词" /><input
              type="button"
              value="搜索"
            />
          </div>
          <div class="contact">
            <li><i class="iconfont icon-fl-dianhua"></i>400-889-8188</li>
            <li><i class="iconfont icon-erji"></i>在线客服</li>
          </div>
        </div>
      </div>
      <!-- 背景*********** -->
      <div class="login-banner">
        <div class="login-content">
          <div class="login-box">
            <div class="box-top">
              <ul>
                <li class="bottom-light">账号登录</li>
              </ul>
              <ul>
                <li>微信扫码登录</li>
              </ul>
            </div>
            <!-- 登录页面 ********************-->
            <div class="box-center-login block">
              <div class="switchover">手机验证码登录</div>
              <!-- 手机验证码登录**** -->
              <div class="phonecodeLog">
                <div class="input-box">
                  <div class="login-input">
                    <i class="iconfont icon-wode"></i
                    ><input type="text" placeholder="请输入用户名" />
                  </div>
                  <p class="logTip"></p>
                </div>
                <div class="input-box">
                  <div class="login-input">
                    <i class="iconfont icon-jiesuo"></i
                    ><input type="password" placeholder="请输入密码" />
                  </div>
                  <p class="logTip"></p>
                </div>
                <input type="button" value="登录" class="logBtn" />
                <h2>忘记密码?</h2>
              </div>
              <!-- 账号密码登录**** -->
              <div class="usercodeLog">
                <div class="input-box">
                  <div class="login-input">
                    <i class="iconfont icon-wode"></i
                    ><input type="text" placeholder="请输入手机号" />
                  </div>
                  <p class="logTip"></p>
                </div>
                <div class="input-box">
                  <div class="login-input">
                    <i class="iconfont icon-yanzhengma"></i
                    ><input type="password" placeholder="请输入短信验证码" />
                    <button class="gainCode">获取验证码</button>
                  </div>

                  <p class="logTip"></p>
                </div>
                <input type="button" value="登录/注册" class="logBtn" />
                <h2>首次登录将自动创建账号</h2>
              </div>
            </div>
            <!-- 微信登录页面 -->
            <div class="box-center-wei">
              <div class="weixinimg">
                <img
                  src="https://m.hua.com/wxapi/tempqrpic?pid=605040edb4864fd883e8502b44d307d9&userid=&type=8&sj=2022-5-8&sign=1480cc9c41195c8b"
                  alt=""
                />
                <h3>微信扫码，快捷登录</h3>
              </div>
            </div>
            <!-- 底部 跳转页面-->
            <div class="box-floor">
              <div class="qq">
                <i class="iconfont icon-qq"></i>
                <h3>QQ</h3>
                <i class="iconfont icon-zhifubao1"></i>
                <h3>支付宝</h3>
              </div>
              <div class="tiaozhuan"><a href="./regin.html"> 注册账号></a></div>
            </div>
          </div>
        </div>
      </div>
      <!-- 底部***************** -->
      <div class="public-buttom">
        <div class="box1">
          <ul>
            <a href="./index.html">
              <li>首页</li>
            </a>
            <b>|</b>
            <a href=""> <li>关于我们</li> </a
            ><b>|</b>
            <a href=""> <li>媒体报道</li> </a
            ><b>|</b>
            <a href=""> <li>联系方式</li> </a
            ><b>|</b>
            <a href=""> <li>企业团购</li> </a
            ><b>|</b>
            <a href=""> <li>花店入驻</li> </a
            ><b>|</b>
            <a href=""> <li>友情链接</li> </a
            ><b>|</b>
            <a href=""> <li>在线补款</li> </a
            ><b>|</b>
            <a href="">
              <li>为什么选择花礼网</li>
            </a>
          </ul>
        </div>
        <div class="box2">
          <img src="./images/regin/slogan.png" alt="" /><img
            src="./images/regin/100.jpg"
            alt=""
          /><img src="./images/regin/bico1.jpg" alt="" /><img
            src="./images/regin/bico2.jpg"
            alt=""
          />
        </div>
        <div class="box3">
          <a href="">中国花卉协会会员</a><a href="">中国电子商务协会会员 </a
          ><em href="">ICP经营许可证：</em><a href="">粤B2-20050744 </a
          ><a href=""> | 粤ICP备09171662号</a
          ><em href="">粤公网安备44030502000373号 Copyright © 2005-2022</em>
        </div>
        <div class="box4">
          <a href="http://www.hua.com">www.hua.com </a
          ><em>深圳市百易信息技术有限公司</em>
        </div>
      </div>
    </div>
    <script>
      get("/products/38").then((res) => {
        console.log(res.data);
      });
      get("/products").then((res) => {
        console.log(res.data);
      });
      get("/banners", { category: 1 }).then((res) => {
        console.log(res.data);
      });
      let lightLi = document.querySelectorAll(".box-top ul li");
      let logLight = document.querySelector(".box-center-login");
      let regLight = document.querySelector(".box-center-wei");
      //定义个变量记录谁被点击了
      let light = 0;
      lightLi.forEach(function (v, i) {
        v.onclick = function () {
          lightLi[light].classList.remove("bottom-light");
          lightLi[i].classList.add("bottom-light");
          if (lightLi[0].className == "bottom-light") {
            regLight.className = "box-center-wei";
            logLight.className = "box-center-login block";
          } else {
            logLight.className = "box-center-login";
            regLight.className = "box-center-wei block";
          }
          light = i;
        };
      });
      //获取登录输入框
      let ipts = document.querySelectorAll(".login-input input");
      //获取全部提示框
      let tips = document.querySelectorAll(".input-box p");
      //登录用户名
      isName = false;
      logNameReg = /^.{2,10}$/;
      ipts[0].oninput = function () {
        if (logNameReg.test(ipts[0].value)) {
          tips[0].innerHTML = "格式输入正确";
          tips[0].style.color = "green";
          isName = true;
        } else {
          tips[0].innerHTML = "请检查格式";
          tips[0].style.color = "red";
          isName = false;
        }
      };
      //登录密码
      isPw = false;
      logPwReg = /^\w{6,18}$/;
      ipts[1].oninput = function () {
        //激活一下用户名输入框
        ipts[0].oninput();
        if (logPwReg.test(ipts[1].value)) {
          tips[1].innerHTML = "格式输入正确";
          tips[1].style.color = "green";
          isPw = true;
        } else {
          tips[1].innerHTML = "请检查格式";
          tips[1].style.color = "red";
          isPw = false;
        }
      };

      // 登录前判断是否有用户登录
      let loginName = document.querySelector(".loginName");
      let quitName = document.querySelector(".quitName");
      let has = localStorage.getItem("username");
      if (has) {
        console.log(has);
        loginName.innerHTML = "你好" + has;
        quitName.innerHTML = "退出";
        loginName.href = "javascript:void(0)";
        quitName.href = "javascript:void(0)";
      }
      if (quitName.innerHTML == "退出") {
        quitName.onclick = function () {
          localStorage.removeItem("username");
          localStorage.removeItem("token");
          // localStorage.clear();全部清空
          quitName.innerHTML = "注册";
          loginName.innerHTML = "你好，请登录";
          loginName.href = "./login.html";
          quitName.href = "./regin.html";
        };
      }
      //登录按钮
      let logBtn = document.querySelector(".logBtn");
      logBtn.onclick = function () {
        if (isName && isPw) {
          let userName = ipts[0].value;
          let password = ipts[1].value;
          post("/auth/login", { userName, password }).then((res) => {
            if (res.code == 1) {
              alert("登录成功");
              localStorage.setItem("token", res.data);
              localStorage.setItem("username", userName);
              loginName.innerHTML = "你好" + userName;
              quitName.innerHTML = "退出";
              location.href = `./index.html`;
            }
          });
        } else {
          alert("用户名或密码输入错误");
        }
      };
      //账号登录切换手机验证码
      let switchover = document.querySelector(".login-banner .switchover");
      let phonecodeLog = document.querySelector(".login-banner .phonecodeLog");
      let usercodeLog = document.querySelector(".login-banner .usercodeLog");
      let switchoverNum = 0;
      switchover.onclick = function () {
        switchoverNum++;
        if (switchoverNum % 2 != 0) {
          switchover.innerHTML = "账号密码登录";
          switchover.style.marginLeft = 215 + "px";
          phonecodeLog.style.display = "none";
          usercodeLog.style.display = "block";
        } else {
          switchover.innerHTML = "手机验证码登录";
          switchover.style.marginLeft = 205 + "px";
          usercodeLog.style.display = "none";
          phonecodeLog.style.display = "block";
        }
      };
    </script>
  </body>
</html>
