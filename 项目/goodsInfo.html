<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="./js/axios.min.js"></script>
    <script src="./js/index.js"></script>
    <link rel="stylesheet" href="./css/reset.css" />
    <link rel="stylesheet" href="./css/public.css" />
    <link rel="stylesheet" href="./css/goodsInfo.css" />
    <link
      rel="stylesheet"
      href="http://at.alicdn.com/t/font_2983992_i3xxbadn1lf.css"
    />
  </head>
  <body>
    <div id="goods">
      <!-- 顶部导航***** -->
      <div class="public-nav">
        <div class="nav-content">
          <div class="nav-left">
            <a href="javascript:void(0)"
              ><i class="iconfont icon-favorfill"></i>收藏花礼网(hua.com)</a
            >
            <a href="javascript:void(0)" class="nav-dropdown"
              ><i class="iconfont icon-weixin"></i>关注微信
              <b class="weixin"
                ><img src="./images/regin/wxguanjia.png" alt="" />
                <h4>扫码关注</h4>
                <h5>回复"礼物"更多惊喜！</h5></b
              ></a
            >
            <a href="javascript:void(0)" class="nav-dropdown"
              ><i class="iconfont icon-shouji1"></i>花礼网App<b
                ><img src="./images/regin/app.png" alt="" />
                <h4>新人专享100元APP礼包</h4></b
              ></a
            >
          </div>
          <div class="nav-right">
            <a href="./login.html" class="loginName">你好，请登录</a>
            <a href="./regin.html" class="quitName">注册</a>
            <a href="javascript:void(0)"><span>订单查询</span></a>
            <a href="javascript:void(0)"><span>我的花礼</span></a>
            <a href="javascript:void(0)"><span>客户服务</span></a>
            <a href="cart.html" class="nav-dropdown"
              ><span
                ><i class="iconfont icon-gouwugouwuchedinggou"></i>购物车<b
                  class="cart"
                  ><h4>您的购物车中没有商品，先去选购吧！</h4></b
                ></span
              ></a
            >
            <a href="javascript:void(0)"
              ><span>鲜花礼品网：中国领先的鲜花网品牌</span></a
            >
          </div>
        </div>
      </div>
      <!-- 头部****** -->
      <div class="public-header">
        <div class="header-content">
          <a href="./index.html">
            <img src="./images/regin/big-logo.png" alt=""
          /></a>
          <div class="search-box Fleft">
            <div class="search">
              <i class="iconfont icon-Magnifier"></i>
              <input type="text" placeholder="商品搜索" />
              <input type="button" value="搜索" />
            </div>
            <div class="search-hotword">
              <a href="">红玫瑰</a>
              <a href="">永生花</a>
              <a href="">生日鲜花</a>
              <a href="">礼品卡</a>
            </div>
          </div>
          <div class="contact">
            <li><i class="iconfont icon-fl-dianhua"></i>400-889-8188</li>
            <li><i class="iconfont icon-erji"></i>在线客服</li>
          </div>
        </div>
      </div>
      <!-- 导航********* -->
      <div class="index-box">
        <div class="index-nav centerPage">
          <div class="nav-left Fleft">
            <a href=""
              ><i class="iconfont icon-gengduo Fleft"></i>
              <h2 class="Fleft">所有分类</h2></a
            >
            <div class="dropdown-cate"></div>
          </div>
          <div class="nav-right Fleft">
            <ul>
              <a href="index.html">
                <li>首页</li>
              </a>
              <a href="">
                <li>鲜花</li>
              </a>
              <a href="">
                <li>永生花</li>
              </a>
              <a href="">
                <li>蛋糕</li>
              </a>
              <a href="">
                <li>礼品</li>
              </a>
              <a href="">
                <li>巧克力</li>
              </a>
              <a href="">
                <li>花语大全</li>
              </a>
              <a href="">
                <li>企业团购</li>
              </a>
              <a href="">
                <li>设计师臻选鲜花</li>
              </a>
              <a href="">
                <li>护士节鲜花礼物</li>
              </a>
            </ul>
          </div>
        </div>
      </div>
      <!-- 主要信息****** -->
      <div class="info">
        <div class="info-content centerPage">
          <div class="info-nav centerPage"></div>
          <div class="info-left Fleft"></div>
          <div class="info-right Fleft">
            <div class="name"></div>
            <div class="price">
              <div class="price-item">
                <div class="price-l">售价：</div>
                <div class="price-c"></div>
                <div class="price-r"></div>
              </div>
              <div class="price-bottom"></div>
            </div>
            <div class="huayu">
              <div class="huayu-item">
                <div class="huayu-l Fleft">花语：</div>
                <div class="huayu-r"></div>
              </div>
              <div class="huayu-material">
                <div class="huayu-l Fleft">材料：</div>
                <div class="huayu-r"></div>
              </div>
            </div>
            <div class="area">
              <div class="area-title">
                <div class="area-l Fleft">配送说明：</div>
                <div class="area-r">全国</div>
              </div>
              <div class="area-item"></div>
            </div>
            <div class="btn-group">
              <div class="addCart">
                <i class="iconfont icon-gouwugouwuchedinggou"></i>
                <h2>加入购物车</h2>
              </div>
              <div class="buy"><h2>立即购买</h2></div>
              <a href="" class="collect"
                ><i class="iconfont icon-favor"></i>
                <h2>收藏商品</h2></a
              >
            </div>
          </div>
        </div>
        <!-- 悬浮框 -->
        <div class="right-bar">
          <ul>
            <li>
              <a href="cart.html">
                <i class="iconfont icon-gouwugouwuchedinggou"></i>
                <h2>购物车</h2>
              </a>
            </li>
            <li>
              <a href="">
                <i class="iconfont icon-erji"></i>
                <h2>在线客服</h2>
              </a>
            </li>
            <li>
              <a href="">
                <i class="iconfont icon-jiankangma"></i>
                <h2>App/微信</h2>
              </a>
              <div class="saoma">
                <div class="saoma-wei">
                  <img src="./images/regin/wxguanjia.png" alt="" />
                  <h2>关注公众号有好礼</h2>
                </div>
                <div class="saoma-app">
                  <img src="./images/regin/app.png" alt="" />
                  <h2>下载花礼App</h2>
                  <h3>随心随地看商品</h3>
                </div>
              </div>
            </li>

            <li>
              <a href="">
                <i class="iconfont icon-fl-dianhua"></i>
                <h2>联系电话</h2>
              </a>
            </li>
            <li>
              <a href="">
                <i class="iconfont icon-edit"></i>
                <h2>意见反馈</h2>
              </a>
            </li>
            <li>
              <a href="javascript:void(0)" class="goTop">
                <i class="iconfont icon-huidaodingbu"></i>
                <h2>回顶部</h2>
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div class="span"></div>
      <!-- 底部***************** -->
      <div class="public-buttom">
        <div class="box1 colorW">
          <ul>
            <a href="./index.html">
              <li class="">首页</li>
            </a>
            <b>|</b>
            <a href=""> <li>关于我们</li> </a
            ><b>|</b>
            <a href=""> <li>媒体报道</li> </a
            ><b>|</b>
            <a href=""> <li>联系方式</li> </a
            ><b>|</b>
            <a href=""> <li>企业团购</li> </a
            ><b>|</b>
            <a href=""> <li>花店入驻</li> </a
            ><b>|</b>
            <a href=""> <li>友情链接</li> </a
            ><b>|</b>
            <a href=""> <li>在线补款</li> </a
            ><b>|</b>
            <a href="">
              <li>为什么选择花礼网</li>
            </a>
          </ul>
        </div>
        <div class="box3">
          <a href="" class="ML10">中国花卉协会会员</a
          ><a href="">中国电子商务协会会员 </a><em href="">ICP经营许可证：</em
          ><a href="">粤B2-20050744 </a><a href=""> | 粤ICP备09171662号</a
          ><em href="">粤公网安备44030502000373号 Copyright © 2005-2022</em>
        </div>
        <div class="box4">
          <em class="ML10">花礼网</em>
          <a href="http://www.hua.com">www.hua.com </a
          ><em> 中国领先的鲜花礼品网，品牌鲜花网服务，鲜花速递专家！</em>
        </div>
        <div class="box2">
          <img src="./images/regin/slogan.png" alt="" /><img
            src="./images/regin/100.jpg"
            alt=""
          /><img src="./images/regin/bico1.jpg" alt="" /><img
            src="./images/regin/bico2.jpg"
            alt=""
          />
        </div>
      </div>
    </div>
    <!-- 登录前判断是否有用户登录 -->
    <script>
      let loginName = document.querySelector(".loginName");
      let quitName = document.querySelector(".quitName");
      let has = localStorage.getItem("username");
      if (has) {
        loginName.innerHTML = "你好" + has;
        quitName.innerHTML = "退出";
        loginName.href = "javascript:void(0)";
        quitName.href = "javascript:void(0)";
      }
      if (quitName.innerHTML == "退出") {
        quitName.onclick = function () {
          localStorage.removeItem("username");
          localStorage.removeItem("token");
          // localStorage.clear();全部清空
          quitName.innerHTML = "注册";
          loginName.innerHTML = "你好，请登录";
          loginName.href = "./login.html";
          quitName.href = "./regin.html";
        };
      }
    </script>
    <!-- 侧边悬浮框**** -->
    <script>
      let referElem = document.querySelector("#goods .info");
      let bar = document.querySelector("#goods .right-bar");
      let goTop = document.querySelector("#goods .goTop");
      window.onscroll = function () {
        let height = referElem.offsetTop - document.documentElement.scrollTop;
        if (height <= 0) {
          bar.style.position = "fixed";
          bar.style.top = 30 + "px";
        } else {
          bar.style.position = "absolute";
        }
      };
      goTop.onclick = function () {
        document.documentElement.scrollTop = 0;
      };
    </script>
    <script>
      //   可以处理 url中 aaa=22&bbb=2323-- 转为了对象
      let obj = new URLSearchParams(location.search);
      // 通过 id 获取了  id等号后面的值
      let id = obj.get("id");
      let url = `/products/${id}`;
      get(url).then((res) => {
        let pObj = res.data;
        console.log(pObj.price);
        let str1 = `  
        <h1>${pObj.name}</h1>
        `;
        let str2 = `  
        <p>￥${pObj.price}</p><i></i>
        `;
        let str3 = `  
        <img src="http://localhost:1337${pObj.coverImage}" alt="" />
        `;
        let str4 = `  
        <p>${pObj.desc}</p>
        `;
        let huayu = pObj.content.slice(
          pObj.content.indexOf("【") + 1,
          pObj.content.lastIndexOf("】")
        );
        document.querySelector(".info .info-left").innerHTML = str3;
        document.querySelector(".info .info-right .name").innerHTML = str1;
        document.querySelector(
          ".info .info-right .huayu .huayu-item .huayu-r"
        ).innerHTML = str4;
        document.querySelector(
          ".info .info-right .huayu .huayu-material .huayu-r"
        ).innerHTML = huayu;
        document.querySelector(".info .info-right .price .price-c").innerHTML =
          str2;
        // 折扣价钱
        let reducedPrice = pObj.price + 57;
        document.querySelector(
          ".info .info-right .price .price-c i"
        ).innerHTML = "市场价￥" + reducedPrice;

        //加入购物车
        let addBtn=document.querySelector(".info .info-right .btn-group .addCart");
        addBtn.onclick=function() {
          let url = `/shop_carts`;
          // product
          // 	amount		//	根据传递的数量正负，会自动的计算最新的数量
          // 	price
          let product=pObj.id;
          let amount=1;
          let price=pObj.price;
          post(url,{product,amount,price}).then(r=>{
            alert(r.msg)
          })
        }
      });
    </script>
  </body>
</html>
